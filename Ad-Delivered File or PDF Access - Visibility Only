// Ad-Delivered File or PDF Access (Visibility Only)
//
// Provides low-confidence visibility into browser-initiated access to
// file-themed or PDF-branded domains delivered via online advertising
// infrastructure (gclid, adgroup_id, campaign_id).
//
// This rule is intentionally broad and intended for analyst awareness,
// hunting, and trend analysis only. It is NOT an indicator of compromise
// and should not be escalated without corroborating activity.
//
// No automated response should be associated with this detection.

event.category = "url"
AND event.url.action = "GET"
AND (
    (
        (
            url.address contains ".exe/"
            OR url.address contains ".exe?"
            OR url.address endswith ".exe"
            OR url.address contains ".msi/"
            OR url.address contains ".msi?"
            OR url.address endswith ".msi"
            OR url.address contains ".zip/"
            OR url.address contains ".zip?"
            OR url.address endswith ".zip"
            OR url.address contains ".iso/"
            OR url.address contains ".iso?"
            OR url.address endswith ".iso"
        )
        AND (
            url.address contains "campaign_id"
            OR url.address contains "adgroup_id"
            OR url.address contains "gclid"
        )
    )
    OR (
        url.address matches "https?://[^/]*pdf[^/]*\\.com/"
        AND (
            url.address contains "campaign_id"
            OR url.address contains "adgroup_id"
            OR url.address contains "gclid"
        )
    )
)
AND NOT (
    url.address contains "utm_campaign="
    OR url.address contains "utm_medium=email"
    OR url.address matches "https?://www\\.zip[a-z0-9-]*\\.com/"
    OR url.address matches "https?://www\\.iso[a-z0-9-]*\\.com/"
    OR url.address matches "https?://www\\.msi[a-z0-9-]*\\.com/"
    OR url.address matches "https?://www\\.exe[a-z0-9-]*\\.com/"
)
