// Ad-Delivered PDF Site Access – Malvertising Risk
//
// Detects browser-initiated access to PDF-themed domains commonly abused
// in malvertising campaigns, where the destination URL contains online
// advertising identifiers (gclid, campaign_id, adgroup_id).
//
// These sites frequently masquerade as legitimate PDF tools or document
// viewers and are used to redirect users toward malware, fake updates,
// or follow-on executable downloads.
//
// Exclusions at the bottom of this rule represent PDF-related domains
// that are already blocked or otherwise controlled in this environment.
// This significantly reduces alert noise.
//
// Each organization should review alert results and add their own
// environment-specific exclusions as needed.

event.category = "url"
AND event.url.action = "GET"
AND (
    url.address matches "https?://[^/]*pdf[^/]*\\.com/"
    AND (
        url.address contains "campaign_id"
        OR url.address contains "adgroup_id"
        OR url.address contains "gclid"
    )
)
AND NOT (
    url.address contains "utm_campaign="
    OR url.address contains "utm_medium=email"

    // Example blocked / controlled PDF domains — replace with your own
    OR url.address matches "https?://www\\.YOURBLOCKEDDOMAINSHERE\\.com/"
    OR url.address matches "https?://www\\.YOURBLOCKEDDOMAINSHERE2\\.com/"
    OR url.address matches "https?://www\\.YOURBLOCKEDDOMAINSHERE3\\.com/"
)

